\documentclass[reqno,T1]{amsproc}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{multicol}
\usepackage[canadian]{babel}
\usepackage{xcolor}
\usepackage{geometry}
\usepackage{xifthen} % provides \isempty
\usepackage{xparse} % new commands with more than one optional argument

% commutative diagrams
\usepackage{tikz}
\usetikzlibrary{arrows,cd,decorations.markings,shapes.geometric,shapes}

% color of links
\definecolor{myurlcolor}{rgb}{0,0,0.4}
\definecolor{mycitecolor}{rgb}{0,0.5,0}
\definecolor{myrefcolor}{rgb}{0.5,0,0}
\usepackage[pagebackref,draft=false]{hyperref}
\hypersetup{colorlinks,
linkcolor=myrefcolor,
citecolor=mycitecolor,
urlcolor=myurlcolor}
\renewcommand*{\backref}[1]{$\uparrow$\,#1}

% general mathematical macros
\renewcommand{\H}{\mathcal{H}}	% Hilbert space
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\op}{\mathrm{op}}
\newcommand{\eps}{\varepsilon}
\newcommand{\lin}[1]{\mathrm{lin}(#1)}
\newcommand{\dom}{\mathrm{dom}}
\newcommand{\supp}{\mathrm{supp}}

% categories
\newcommand{\cat}[1]{\mathsf{#1}}		% generic category
\newcommand{\Set}{\mathsf{Set}}
\newcommand{\Vect}[1]{\mathsf{Vect}_{#1}}	% vector spaces over a field
\newcommand{\Ban}{\mathsf{Ban}}			% (complex) Banach spaces
\newcommand{\Hilb}{\mathsf{Hilb}} 		% Hilb, cat of Hilbert spaces
\newcommand{\Rep}[1]{\mathsf{Rep}(#1)}		% cat normal Hilbert space reps of a C$^*$-algebra
\newcommand{\NRep}[1]{\mathsf{NRep}(#1)}	% cat of normal Hilbert space reps of a W$^*$-algebra
\newcommand{\id}[1]{1_{#1}}			% identity morphism

% Theorem Environments
\swapnumbers
\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{conj}[thm]{Conjecture}
\newtheorem{qstn}[thm]{Question}
\newtheorem{defn}[thm]{Definition}
\newtheorem{lemdefn}[thm]{Lemma + Definition}
\newtheorem{prob}[thm]{Problem}
\theoremstyle{remark}
\newtheorem{ex}[thm]{Example}
\newtheorem{rem}[thm]{Remark}
\newtheorem{note}[thm]{Note}
\numberwithin{equation}{section}

%%%%%%%%%%%% Enumeration via lowercase letters
\renewcommand{\labelenumi}{(\alph{enumi})}
\renewcommand{\theenumi}{(\alph{enumi})}
\renewcommand{\labelitemi}{$\circ$}

%%% pagebreaks allowed for align environment
\allowdisplaybreaks

% string diagram stuff
\pgfdeclarelayer{edgelayer}
\pgfdeclarelayer{nodelayer}
\pgfsetlayers{edgelayer,nodelayer,main}
\tikzstyle{none}=[inner sep=0pt]
\tikzstyle{simple}=[-,draw=black,line width=1.000]
\tikzstyle{bn}=[circle,inner sep=2pt,fill=black,draw=black,line width=0.8 pt]

%%% draft stuff
\usepackage[draft]{showkeys}
\usepackage{todonotes}
\newcommand{\tob}[1]{\todo[color=blue!40,inline]{#1}}


%-------------------------------------------------------------------

\begin{document}
\sloppy

% vertical spacing in multiline equations
\setlength{\jot}{6pt}

%-------------------------------------------------------------------

%%%%%%%%%%%% title page stuff %%%%%%%%%%%%%%%%%%%%%%%%%%

\title{The universal property of direct integrals in W$^*$-categories}

\author{Tobias Fritz, Robert Furber, Bas Westerbaan}

\address{Max Planck Institute for Mathematics in the Sciences, Leipzig, Germany}
\email{fritz@mis.mpg.de}

\keywords{}

\subjclass[2010]{Primary: ; Secondary: }

\thanks{\textit{Acknowledgements.} }

\begin{abstract}
Using enrichment in Banach spaces, we observe that one can formulate universal properties characterizing universal objects in C$^*$-categories in such a way that they guarantee uniqueness up to unique unitaries. We then formulate such a universal property for infinite direct sums in W$^*$-categories, and prove that this indeed characterizes the standard infinite direct sums in the W$^*$-category of normal representations of a W$^*$-algebra. We do the same for direct integrals, in which case we need to work with measurable W$^*$-categories.
\end{abstract}

\maketitle

\section{Introduction}


\section{C$^*$-categories}

For this section, we work in a C$^*$-category \cite{wstarcat} denoted by $\cat{C}$.
We start with a generalization of~\cite[Lemma 7]{westerbaan2016universal}
    to C$^*$-categories.

\begin{lem}
For any~$a\colon A \to B$ with~$\|a\| \leq 1$
    and projections~$s \colon A \to A$,
        $t\colon B\to B$,
	the following are equivalent:
\begin{enumerate}
\item $a^* t a \leq 1-s$,
\item $a s a^* \leq 1 - t$,
\item $tas = 0$,
\item $sa^* t = 0$.
\end{enumerate}
\label{contrapositionlemma}
\end{lem}
\begin{proof}
We will first prove~$a^*t a \leq 1-s \Leftrightarrow tas=0$.
    Assume~$a^* t a \leq 1-s$.
    Then~$0 \leq s a^* t a s \leq s (1-s) s = 0$.
    Thus~$s a^* t a s = 0$, which is to say~$tas = 0$.
    Now, assume~$tas = 0$.
    Then~$ta = ta(1-s)$ and~$a^*t = (1-s)a^* t$.
    Hence~$a^* ta = (1-s)a^*ta(1-s) \leq (1-s)$.
A similar argument proves~$as a^* \leq 1-t \Leftrightarrow sa^*t=0$.
To finish the proof, it is sufficient to
        show~$tas=0 \Leftrightarrow sa^*t=0$, which follows directly
        by applying~$(\ )^*$.
\end{proof}

\begin{lem}
Let~$a \colon A \leftrightarrows B \colon b$ be any two morphisms
    such that~$\|a \| \leq 1$ and $\| b\| \leq 1$ and~$ab=1$.
    Then~$b$ is an isometry with~$a=b^*$.
\label{isometrylemma}
\end{lem}
\begin{proof}
    To start, note~$\|a ^*a\| = \|a\|^2 \leq 1$, so~$a^*a \leq 1$.
    Similarly~$b^*b \leq 1$.
    Combined~$1 = b^*a^*ab \leq b^*b \leq 1$, hence~$b^*b=1$.
    Similarly~$aa^*=1$.
    Clearly~$bb^*bb^* = b 1 b^* = bb^*$, so~$b$ is an isometry.
    Now~$a (1-bb^*) a^* = aa^* - abb^*a^* = 1-1=0$
    So~$a^* (1-0) a \leq bb^*$ by Lemma~\ref{contrapositionlemma}.
    Similarly~$bb^* \leq a^*a$. Hence~$bb^*=a^*a$.
    We are done: $a = aa^*a=abb^*=b^*$.
\end{proof}

We will need the full power of this result only in the next section, but the following special case is generally useful for the definition of universal properties in C$^*$-categories:

\begin{cor}
Let $u : A \to B$ be an invertible morphism with $\| u \| \leq 1$ and $\| u^{-1} \| \leq 1$. Then $u$ is unitary.
\label{unitaries}
\end{cor}

Now let $\Ban$ be the category of Banach spaces with bounded linear maps of norm $\leq 1$. Every C$^*$-category is $\Ban$-enriched. Lemma~\ref{unitaries} and the Yoneda lemma imply that for any representable functor $\cat{C} \to \Ban$, the representing object is unique up to unique \emph{unitary} isomorphism. This is a desideratum of a notion of universal property for C$^*$-categories, and more generally for all dagger categories~\cite{daglims}. The lemma tells us that the compatibility with the dagger structure is automatic thanks to the enrichment in $\Ban$, so that we do not need to formulate our universal properties in the form of dagger limits as in~\cite{daglims}.

In summary, our notion of universal property in a C$^*$-category is the standard one for enriched categories, namely with enrichment in $\Ban$:

\begin{defn}
A functor $F : \cat{C} \to \Ban$ is \emph{representable} if there is an object $A \in \cat{C}$ together with a natural isomorphism $\cat{C}(A,-)\cong F$ that is a componentwise isometric isomorphism of Banach spaces.
\end{defn}

Moreover, thanks to Corollary~\ref{unitaries}, the representing object is unique up to a unique unitary: if both $A$ and $B$ represent $F$ via $\cat{C}(A,-)\cong F\cong \cat{C}(B,-)$, then the Yoneda lemma gives us an isomorphism $u : A \to B$. Since the natural isomorphism between the hom-functors is required to be a componentwise isometry, we have $\| u \| = \| u^{-1} \| = 1$, making $u$ into a unitary.

\section{The universal property of infinite direct sums}

We now turn to a particular universal property and study infinite direct sums. (While our considerations also apply to finite direct sums, in this case our discussion provides nothing new, since then it reduces to the well-understood case of biproducts in an additive category.) From now on, we take $C$ to be a W$^*$-category~\cite{wstarcat}, such as $\Hilb$ or $\Rep{A}$, the category of Hilbert space representations of a C$^*$-algebra $A$.

For $(A_i)_{i\in I}$ a family of objects in $\cat{C}$, we consider the functor
\[
	\bigoplus_i \cat{C}(A_i,-) \: : \: \cat{C} \to \Ban
\]
given by associating to every object $B$ the vector space
\[
	\bigoplus_i \cat{C}(A_i , B) := \left\{ (f_i : A_i \to B)_{i\in I} \Biggm\vert \sum_i f_i f_i^* < \infty \right\},
\]
considered as a Banach space under the norm
\[
	\| (f_i)_{i \in I} \| := \left\| \sum_i f_i f_i^* \right\|^{1/2}.
\]
This is functorial in $B$ in the obvious way.

\begin{lem}
$\bigoplus_i \cat{C}(A_i,-)$ is complete, and therefore a Banach space.
\end{lem}

The proof is analogous to the standard proof showing that $\ell^2(I)$ is a Hilbert space. \tob{I haven't done this yet, so for now this statement is wishful thinking}

\begin{proof}
Suppose that we are given a Cauchy sequence of families $( ( f_i^{(n)} )_{i\in I} )_{n\in\N}$.

\todo{Complete this! Showing that $(f_i^{(n)})_{n\in\N}$ is Cauchy for each $i$ needs some form of Cauchy-Schwarz}
\end{proof}

We now get to our main definition:

\begin{defn}
\label{directsumdef}
An \emph{$I$-indexed direct sum} of the family of objects $(A_i)_{i\in I}$ is an object $\bigoplus_i A_i$ which represents the $\Ban$-enriched functor $\bigoplus_i \cat{C}(A_i,-)$.
\end{defn}

By the discussion of the previous section, this characterizes infinite direct sums up to unique unitaries. Since we are in a dagger category, the same holds dually, meaning that $\bigoplus_i A_i$ also represents the functor
\[
	\bigoplus_i \cat{C}(-,A_i) \: : \: \cat{C}^\op \to \Ban
\]
given by associating to every object $B$ the vector space
\[
	\bigoplus_i \cat{C}(B, A_i) := \left\{ (f_i : B \to A_i)_{i\in I} \Biggm\vert \sum_i f_i^* f_i < \infty \right\},
\]
with norm
\[
	\| (f_i)_{i \in I} \| := \left\| \sum_i f_i^* f_i \right\|^{1/2},
\]
which is functorial in $B$ in the obvious way.

\begin{thm}
The following are equivalent:
\begin{enumerate}
\item\label{universalprop} $\bigoplus_i A_i$ is an $I$-indexed direct sum.
\item\label{biprodsum} There is a family of morphisms $\left(\kappa_j : A_j \to \bigoplus_i A_i\right)_{j\in I}$ such that $\kappa_j^*\kappa_k = \delta_{jk}$, and
\beq
\label{complete}
	\sum_j \kappa_j \kappa_j^* = 1_{\bigoplus_i A_i}
\eeq
ultraweakly.
\end{enumerate}
\end{thm}

\begin{proof}
We write $A$ as shorthand for $\bigoplus_i A_i$.

Assuming \ref{universalprop}, we define $(\kappa_j : A_j \to A)$ to be the family that corresponds to $\id{A}$ under the given isomorphism $\bigoplus_i \cat{C}(A_i,A) \cong \cat{C}(A,A)$. For fixed $j\in J$, also the family $(\delta_{ij} : A_i \to A_j)$ corresponds to some morphism $\pi_j : A \to A_j$. Applying naturality with respect to $\pi_j$ gives the diagram
\[\begin{tikzcd}
	\bigoplus_i \cat{C}(A_i,A) \ar{r}{\cong} \ar{d}{(\pi_j\circ -)_i} & \cat{C}(A,A) \ar{d}{\pi_j\circ -} \\
	\bigoplus_i \cat{C}(A_i,A_j) \ar{r}{\cong} & \cat{C}(A,A_j)
\end{tikzcd}\]
Starting with the family $(\kappa_i)$ on the upper left, we get $(\pi_j\circ\kappa_i)$ by going down, or alternatively $(\delta_{ij})$ by going around; therefore we have $\pi_j \kappa_i = \delta_{ij}$. By the isometric isomorphism assumption, we moreover have $\| \id{A} \| = \| \sum_i \kappa_i \kappa_i^* \|$, and therefore $\| \kappa_j \| \leq 1$; and similarly $\| \pi_j \| \leq 1$. By Lemma~\ref{isometrylemma}, this implies $\pi_j = \kappa_j^*$. We therefore have $\kappa_j^*\kappa_i = \delta_{ij}$, as desired. This also implies that the $\kappa_j \kappa_j^*$ are mutually orthogonal projections. In order to also prove the completeness relation~\eqref{complete}, let $p : A\to A$ be any other projection that is orthogonal to each of the $\kappa_j \kappa_j^*$; we need to show $p = 0$. Again by naturality, under the isomorphism $\bigoplus_i \cat{C}(A_i,A)$, the new $p$ corresponds to the family $(p\kappa_i) = (0)$. This implies indeed $p=0$.

Assuming \ref{biprodsum}, \todo{write this}
\end{proof}

\begin{rem}
For finite $I$, these direct sums are also dagger limits in the sense of~\cite{daglims}. For infinite $I$, this is no longer the case, since infinite direct sums are not even limits in the usual $\cat{Set}$-enriched sense; compare~\cite[Theorem~5.2]{daglims}. Hence our definition are better adapted to the context of W$^*$-categories, such as $\cat{Hilb}$, than those of~\cite{daglims}.
\tob{We can tone down the last sentence a bit if it's too demeaning}
\end{rem}

\newcommand{\alg}{N}	% a W$^*$-algebra

For a W$^*$-algebra $\alg$, we let $\NRep{\alg}$ be its category of normal representations on Hilbert spaces. For example, $\alg$ may be the double dual of a C$^*$-algebra, in which case $\NRep{\alg}$ is equivalent to the category of representations of the C$^*$-algebra.\footnote{Our choice of font $\alg$ is the same as that for categories, suggesting that $\alg$ may as well more generally be a small W$^*$-category, and the same statements would hold. Since one can always take the convolution W$^*$-algebra of any small W$^*$-category, resulting in the same category of representations, there is no loss of generality in restricting ourselves to W$^*$-algebras.}

\begin{thm}
In $\NRep{\alg}$, any $\ell^2$-direct sum
\[
	\bigoplus A_i := \left\{ (\xi_i)_{i\in I} \Biggm \vert \xi_i\in A_i,\: \sum_i \langle\xi_i,\xi_i\rangle < \infty \right\},
\]
equipped with the blockwise representation of $\alg$, is indeed an \emph{$I$-indexed direct sum} in the sense of Definition~\ref{directsumdef}. Every $I$-indexed direct sum in $\NRep{\alg}$ is of this form.
\end{thm}

\begin{proof}
\todo[inline]{do this}
\end{proof}

\section{Direct integrals}

\newcommand{\Obj}[1]{\mathrm{Obj}(#1)}
\newcommand{\Mor}[1]{\mathrm{Mor}(#1)}

\begin{defn}
A \emph{measurable category} $\cat{C}$ is a category internal to measurable spaces. A \emph{measured family of objects} indexed by a measure space $(X,\Sigma,\mu)$ is a measurable function $A : X\to\Obj{\cat{C}}$.
\end{defn}

For $(A_x)_{x\in X}$ a measured family of objects in $\cat{C}$, we now consider the functor
\[
	\int_X \cat{C}(A_x,-) \: : \: \cat{C}\to\Set
\]
given by associating to every object $B$ the set
\[
	\int_X \cat{C}(A_x , B) := \left\{ f : X\to\Mor{\cat{C}} \textrm{ measurable} \Biggm\vert f_x : A_x\to B,\: \int_X f_x f_x^* \,dx < \infty \right\},
\]
which is functorial in $B$ in the obvious way.

\todo[inline]{Is this the ``right'' definition? What is the relation to~\cite{measureablecats}?}

\begin{defn}
A W$^*$-category \emph{has direct integrals} if it has direct integrals for $\sigma$-finite measure spaces and arbitrary direct sums.
\end{defn}

\todo[inline]{Is the restriction to $\sigma$-finite the ``right'' definition?}

Due to the existence of countable direct sums, we could as well restrict to direct integrals on finite measure spaces:

\begin{prop}
If countable direct sums and direct integrals for finite measure spaces and exist, then so do direct integrals for $\sigma$-finite measure spaces.
\end{prop}

If everything works out, this is due to a nice kind of compositionality of direct integrals (essentially Fubini's theorem).

\todo[inline]{Prove Fubini's theorem for direct integrals from the universal property?}

\bibliographystyle{plain}
\bibliography{direct_integrals}

\end{document}

% vim: ft=tex.latex
